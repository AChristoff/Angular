<div class="wrapper">
  <h1>Register</h1>
  
  <div *ngIf="spinner" class="spinner">
    <mat-spinner></mat-spinner>
  </div>
  
  <mat-horizontal-stepper [selectedIndex]="currentStep">
    <mat-step editable="false" completed="true">
      <ng-template matStepLabel>Enter email</ng-template>
    </mat-step>
    <mat-step editable="false">
      <ng-template matStepLabel>Enter password</ng-template>
    </mat-step>
    <mat-step >
      <ng-template matStepLabel>Done</ng-template>
    </mat-step>
  </mat-horizontal-stepper>
  
  <form *ngIf="currentStep === 1" [formGroup]="form" (submit)="onRegister()" class="register-form">
    
    <div class="form-group group-email">
      
      <mat-form-field class="example-full-width">
        <mat-label>User Name</mat-label>
        
        <input
          required
          matInput
          formControlName="username"
          type="text"
          placeholder="Ex. John">
        
        <mat-icon matSuffix>account_circle</mat-icon>
        
        <mat-error *ngIf="f.username.touched && f.username.errors?.required">This field is required</mat-error>
        <mat-error *ngIf="f.username.errors?.pattern">Username must have only letter, between 2-20.</mat-error>
      
      </mat-form-field>
    
    </div>
    
    <div class="form-group group-password">
      
      <mat-form-field class="example-full-width">
        <mat-label>Password</mat-label>
        
        <input
          required
          matInput
          formControlName="password"
          type="password"
          placeholder="Ex. John#123"
          [type]="hidePass ? 'password' : 'text'">
        
        <button
          type="button"
          mat-icon-button
          matSuffix (click)="hidePass = !hidePass"
          [attr.aria-label]="'Hide password'"
          [attr.aria-pressed]="hidePass">
          <mat-icon>{{hidePass ? 'visibility_off' : 'visibility'}}</mat-icon>
        </button>
        
        <mat-error *ngIf="f.password.touched && f.password.errors?.required">This field is required</mat-error>
        <mat-error *ngIf="f.password.touched && f.password.errors?.pattern">Password must be between 6-40 chars and contain at least one: uppercase / lowercase / special char / digit</mat-error>
      
      </mat-form-field>
    
    </div>
    
    
    <div class="form-group group-password">
      
      <mat-form-field class="example-full-width">
        <mat-label>Confirm Password</mat-label>
        
        <input
          required
          matInput
          formControlName="confirmPassword"
          type="password"
          placeholder=""
          [type]="hideConfPass ? 'password' : 'text'">
        
        <button
          type="button"
          mat-icon-button
          matSuffix (click)="hideConfPass = !hideConfPass"
          [attr.aria-label]="'Hide password'"
          [attr.aria-pressed]="hideConfPass">
          <mat-icon>{{hideConfPass ? 'visibility_off' : 'visibility'}}</mat-icon>
        </button>
        
        <mat-error *ngIf="f.confirmPassword.touched && f.confirmPassword.errors?.required">This field is required</mat-error>
        <mat-error *ngIf="f.confirmPassword.errors?.passwordMismatch">Passwords do not match!</mat-error>
      
      </mat-form-field>
    
    </div>
    
    <button type="submit"
            [disabled]="form.invalid"
            mat-raised-button
            color="primary"
            class="register-btn">Register
    </button>
  
  </form>
  
  <button *ngIf="currentStep === 2" mat-raised-button (click)="onDone()"
          color="primary"
          class="done-btn">Welcome to Dogster!
  </button>
</div>
